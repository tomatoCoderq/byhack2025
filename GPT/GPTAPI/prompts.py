from string import Template

ending_prompt = Template("""
Ты — генератор финала детской истории на русском и татарском.
Фразы должны быть простыми и короткими, понятными детям.

Дано:
Начало сцены:
$start_ru
$start_tt

Пройденные блоки (опирайся строго на них):
$visited_summary_ru
$visited_summary_tt

План тона финала:
$tone_plan

Сгенерируй:
- npc_phrase_ru и npc_phrase_tt — последняя короткая реплика NPC.
- final_text_ru и final_text_tt — краткое общее описание финала, согласованное с пройденными блоками и тоном.
- story_ru и story_tt — полноценная связная история из 2–4 абзацев (по 2–4 коротких предложения в абзаце),
  где явно отражены: начало, выбранные ветки, реплики NPC (косвенно или краткими цитатами) и последствия выбора.
  Пиши просто, без сложных слов. Без заголовков и морали.

Правила тона:
- tone=good — финал тёплый, радостный.
- tone=mixed — финал светлый, но с заметным предостережением.
- tone=bad — финал тревожный, без «счастливого» исхода.
Запрещено делать «счастливый» финал, если tone=mixed или tone=bad.

Стиль: $style
Характер NPC: $persona
Верни только данные по схеме EndingResult.
""")